Master Client Site Blueprint: The "Metal Ministry" Protocol
Context ID: context7 Purpose: This is the definitive guide for onboarding new clients to the Multi-Tenant CMS. It documents the end-to-end workflow from "Legacy Site" to "Modern CMS-Integrated Web App".

Workflow Overview
We follow a strict 5-Phase Protocol for every new client site:

Conversion: HTML/PHP â†’ Next.js Structure
Migration: Static Content â†’ Supabase Database
Redesign: Basic Layout â†’ Premium Industrial Design
Integration: Standalone â†’ Multi-Tenant CMS Connected
Optimization: Dynamic â†’ Static SEO Powerhouse
Phase 1: Legacy Conversion (The "Lift")
Goal: Initialize a modern Next.js 14+ codebase and identify assets from the old site.

Steps:
Scaffolding: Clone the client-site template (this repo).
Asset Extraction: Copy public images/PDFs from the legacy site to public/.
Route Mapping: Identify the key pages from the old site (Home, About, Contact, Product Categories).
ğŸ¤– AI Prompt for Phase 1
"I am starting a new client site called '[Client Name]'.

Clone the current client-site structure as a baseline.
Analyze the provided legacy HTML files (or URL) to understand their navigation structure.
Create a route map: List which legacy URLs map to which Next.js App Router paths."
Phase 2: Data Migration (The "Shift")
Goal: Move hardcoded content into the shared Supabase post table.

Architecture:
Table: public.post
Discriminators:
company_id: UUID (isolates client data).
type: 'product' | 'blog'.
Steps:
Parsing: Write a script (using cheerio + turndown) to read legacy HTML.
Cleaning: Extract Title, Content (convert to Clean HTML or Markdown), and Meta Description.
Insertion: Bulk insert into Supabase using the new company_id.
ğŸ¤– AI Prompt for Phase 2
"I have a folder of legacy HTML product pages.

Write a Node.js script using cheerio to extract the 'Product Title', 'Description', and 'Specifications Table' from each file.
Generate a JSON manifest of this data.
Create a seeding script to insert this JSON into Supabase post table with company_id='[NEW_UUID]' and type='product'."
Phase 3: Redesign (The "Shine")
Goal: Apply the "Premium Industrial" design language.

Design Tokens:
Theme: Industrial (Dark/Light mode support, but heavy use of White/Gray/Blue).
Glassmorphism: Used on cards and overlays.
Typography: Clean Sans-Serif (Inter/Roboto).
Components:
HeroSlider
: Full-width, high-impact imagery.
ProductCatalog
: Grid view with hover effects.
StickySidebar: "Quick Contact" permanently visible.
ğŸ¤– AI Prompt for Phase 3
"Apply the 'Metal Ministry' Premium Industrial theme to this new site.

Update tailwind.config.ts with [Client Primary Color].
Ensure the 
Sidebar
 is sticky and contains the 'Quick Contact' widget.
Style the Homepage Product Grid to be symmetrical and fully responsive.
Use framer-motion for subtle entrance animations on the Hero section."
Phase 4: CMS Integration (The "Connect")
Goal: Enable the Admin Panel to control this site.

Configuration:
Environment: Set NEXT_PUBLIC_COMPANY_ID in .env.local.
Filtering: Ensure all Supabase queries strictly filter by this ID.
Products: .eq('type', 'product')
Blogs: .eq('type', 'blog')
ğŸ¤– AI Prompt for Phase 4
"Connect this site to the CMS.

Set the NEXT_PUBLIC_COMPANY_ID to '[UUID]'.
Verify that 
src/app/products/page.tsx
 fetches ONLY products for this ID.
Verify that 
src/app/blogs/page.tsx
 fetches ONLY blog posts for this ID.
Test that creating a post in the Admin Panel appears instantly on this site."
Phase 5: SEO Optimization (The "Rank")
Goal: Google Ranking Dominance.

Checklist:
Static Generation (ISR):
Use 
generateStaticParams
 in [slug]/page.tsx.
Set revalidate = 3600 (1 hour).
Metadata:
Dynamic 
generateMetadata
 fetching meta_title and meta_description from DB.
Structured Data (JSON-LD):
Inject BlogPosting schema on Blog pages.
Inject 
Product
 schema on Product pages.
ğŸ¤– AI Prompt for Phase 5
"Optimize the site for SEO.

Implement 
generateStaticParams
 for both Product and Blog dynamic routes to ensure they build as static HTML.
Add JSON-LD Structured Data: BlogPosting for blogs and 
Product
 for products.
Ensure the 
Header
 includes semantic nav links and the proper internal linking structure."


Here is the Detailed Summary you requested. You can copy-paste the text below directly into your new chat to give the AI full context of what we achieved and how to proceed.

Session Context Summary: Metal Ministry CMS Multi-Tenant Project
1. Project Overview
We are building a Multi-Tenant Headless CMS where a single Admin Panel manages multiple detached Client Sites.

Admin Panel: cms-task (Next.js, Supabase)
Client Site Template: cms-task/client-site (Next.js, Tailwind, Framer Motion)
Database: Supabase (shared post table structure).
2. Key Achievements in This Session
A. Refined "Metal Ministry" Client Site
Sticky Sidebar: Fixed CSS issues to make the sidebar (with "Quick Contact") permanently visible without internal scrolling.
Homepage: Balanced product grid and redesigned "Request Quote" CTA with glassmorphism.
Flanges Links: Fixed broken sidebar links by mapping them to correct long-form slugs.
B. Implemented Full "Blogs" Feature
Database: Added type column to post table (check (type in ('product', 'blog'))).
Admin Panel: Updated PostForm to include a "Content Type" selector and updated actions.ts.
Client Site:
Navigation: Added "BLOGS" link to Header.
Products Page: Filters post table by .eq('type', 'product').
Blogs Page: Created /blogs to list posts where .eq('type', 'blog').
Blog Post Page: Created /blogs/[slug] with Static Generation (ISR) and JSON-LD Schema for SEO.
C. Created Master Documentation
Artifact: client_site_blueprint.md
Location: C:\Users\Vivek\.gemini\antigravity\brain\813e7c22-e2ec-4731-9781-bd4de5d7a075\client_site_blueprint.md
Purpose: Defines the 5-Phase Protocol (Lift, Shift, Shine, Connect, Rank) for replicating this success across 15+ more client sites.
3. Current System State
Supabase: post table has type column.
Admin: Fully functional for creating Products AND Blogs.
Client Site: Fully functional, separates products/blogs, high-performance SEO.
4. Next Steps for New Session
Replication: Use the client_site_blueprint.md to start the next client site (e.g., "Steel Titans").
Prompting: Provide the "Phase 1 Prompt" from the blueprint to the AI to begin cloning and asset extraction.


Based on our roadmap and architectural decisions, here is the Project Objective & Vision when we started:

ğŸ¯ The Core Objective
To build a scalable Multi-Tenant Headless CMS Factory that allows us to rapidly modernize legacy industrial websites into high-performance Next.js applications.

ğŸ”‘ Key Requirements & Vision
The "One-to-Many" Architecture (Multi-Tenancy)
Vision: We didn't want to build 15 separate Admin Panels for 15 clients.
Solution: A single, unified Admin Dashboard (cms-task) that manages all content for all clients, separated strictly by company_id.
The "Lift & Shift" Strategy (Legacy Migration)
Vision: Take old, clunky HTML/PHP sites (like Metal Ministry) and modernize them without losing their valuable data or SEO ranking.
Solution: A "phase-wise" protocol to parse legacy HTML, clean the data, and migrate it to a structured Supabase database.
Factory-Like Scalability
Vision: Creating a new client site should take days, not weeks.
Solution: A standardized "Client Site Template" (the Blueprint) that can be cloned, branded, and deployed rapidly. This eliminates repetitive setup work.
SEO Dominance
Vision: The new sites must outperform the old ones on Google.
Solution: Next.js App Router with Incremental Static Regeneration (ISR). This gives the speed of a static site (HTML) with the flexibility of a dynamic CMS.
ğŸš€ How It Should Work (The Flow)
Sales: You sign a new client (e.g., "Steel Titans").
Setup: You run the "Phase 1" prompt to clone the template and extract their old data.
Admin: You give the client access to the shared Admin Panel to manage their own blogs/products.
Result: They get a premium, fast, modern website; You get a maintainable, unified codebase.

# MASTER PROTOCOL: Launching a New Client Site
**Process Version:** 3.0 (The "Factory One-Shot" Workflow)
**Goal:** Convert a Legacy HTML site -> Modern Next.js App in < 30 Minutes.

> [!IMPORTANT]
> **Use this file as your primary instruction manual.**
> When starting a new session with an AI, verify it has read this file first.

---

## ğŸ—ï¸ Phase 1: Setup & Extraction (The "Lift")
**Action:** Prepare the workspace and grab the raw materials.

1.  **Clone the Template**:
    *   Copy the entire `client-site` folder to `projects/<new-client-name>`.
    *   Open this new folder in VS Code.

2.  **Mount Legacy Site**:
    *   Create a folder named `legacy_source` in the root.
    *   **Paste the entire old HTML folder** (downloaded from cPanel/FTP) into `legacy_source`.
    *   *Why?* This gives us local access to parse HTML and extract images without network lag.

3.  **Extract Assets**:
    *   Move all images/PDFs from `legacy_source/images` (or `public`) to `src/public/images/products`.
    *   *Tip:* Keep the folder structure if possible to make mapping easier.

---

## ğŸ—„ï¸ Phase 2: Database Preparation
**Action:** Create the "Bucket" for the client's data.

1.  **Create Company**:
    *   Open your **Supabase Dashboard** -> `companies` table.
    *   Insert a new row: `name: "New Client Name"`.
    *   **Copy the returned ID** (e.g., `88e00ef3...`).

2.  **Configure Environment**:
    *   Rename `.env.local.example` -> `.env.local`.
    *   Update `NEXT_PUBLIC_COMPANY_ID` with the ID you just copied.

---

## ğŸ› ï¸ Phase 3: Data Migration (The "Shift")
**Action:** Turn HTML chaos into Structured JSON.

1.  **Analyze Structure**:
    *   Open one HTML file from `legacy_source`.
    *   Identify the "Content Selector" (e.g., `div.product-details`, `table.spec-table`).

2.  **Run the Converter**:
    *   We have a universal script: `src/scripts/parse-legacy.js` (you may need to create/tweak this per client).
    *   **Goal:** Read all HTML files -> Extract Title, Content, Metadata -> Output `migration_data.json`.
    *   *Prompt to AI:* "Parse the HTML files in `legacy_source`. Extract the content inside `.main-container`. Output a JSON file."

3.  **Import to Supabase**:
    *   Run: `node src/scripts/import-industrial.js <COMPANY_ID>`.
    *   *Note:* Ensure the script reads from your new `migration_data.json`.

---

## ğŸ¨ Phase 4: Frontend Integration (The "Connect")
**Action:** Make it look like *their* brand.

1.  **Brand Identity**:
    *   **Logo**: Replace `public/images/logo.png`.
    *   **Favicon**: Replace `public/favicon.ico`.
    *   **Colors**: Open `src/app/globals.css`. Update `--primary` variable to match their brand color.

2.  **Verify Content Connection**:
    *   Run `npm run dev`.
    *   Visit `localhost:3000`.
    *   **Check:** Do you see *their* products? (If yes, Supabase connection is working).

---

## ğŸš€ Phase 5: Deployment & Handover
**Action:** Go Live.

1.  **Build Check**:
    *   Run `npm run build`.
    *   Fix any TypeScript errors (usually 0 if you didn't touch core logic).

2.  **Deploy**:
    *   Push to GitHub.
    *   Connect to Vercel.
    *   **Add Environment Variables** (`NEXT_PUBLIC_SUPABASE_URL`, `ANON_KEY`, `COMPANY_ID`) in Vercel Project Settings.

---

## ğŸ¤– AI Prompt to Start
*Copy-paste this when you open the new project:*

> "I am setting up a new client site: **[Client Name]**.
> I have cloned the codebase and placed their old HTML site in `legacy_source`.
>
> 1.  Help me analyze `legacy_source/index.html` to find the content structure.
> 2.  Help me script the extraction of data into `migration.json`.
> 3.  I have their Company ID: `[UUID]`.
>
> Let's start Phase 3 (Data Migration)."